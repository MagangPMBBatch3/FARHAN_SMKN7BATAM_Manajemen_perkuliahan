type Krs {
    id: ID!
    mahasiswa_id: Int!
    semester_id: Int!
    tanggal_pengisian: DateTime!
    tanggal_persetujuan: DateTime
    status: String!
    total_sks: Int
    catatan: String
    dosen_pa_id: Int
    created_at: DateTime
    updated_at: DateTime
    deleted_at: DateTime
    
    # Relations
    mahasiswa: Mahasiswa! @belongsTo
    semester: Semester! @belongsTo
    dosenPa: Dosen @belongsTo(relation: "dosenPa")
    krsDetail: [KrsDetail!]! @hasMany
}

input CreateKrsInput {
    mahasiswa_id: Int!
    semester_id: Int!
    tanggal_pengisian: DateTime
    status: String
    total_sks: Int
    catatan: String
    dosen_pa_id: Int
}

input UpdateKrsInput {
    id: Int
    mahasiswa_id: Int
    semester_id: Int
    tanggal_pengisian: DateTime
    tanggal_persetujuan: DateTime
    status: String
    total_sks: Int
    catatan: String
    dosen_pa_id: Int
}

type KrsPaginator {
    data: [Krs]!
    paginatorInfo: PageInfo!
}

type PageInfo {
    hasMorePages: Boolean!
    currentPage: Int!
    lastPage: Int!
    perPage: Int!
    total: Int!
}

extend type Query {
    allKrs: [Krs!]! @all(model: "App\\Models\\Krs")
    krs(id: ID! @eq): Krs @find(model: "App\\Models\\Krs")
    
    allKrsPaginate(
        search: String
        first: Int
        page: Int
    ): KrsPaginator @field(resolver: "App\\GraphQL\\Krs\\Queries\\KrsQuery@all")
    
    allKrsArsip(
        search: String
        first: Int
        page: Int 
    ): KrsPaginator @field(resolver: "App\\GraphQL\\Krs\\Queries\\KrsQuery@allArsip")
    
    # Get KRS aktif (semester berjalan) untuk mahasiswa
    currentKrsByMahasiswa(mahasiswa_id: ID!): Krs
        @field(resolver: "App\\GraphQL\\Krs\\Queries\\KrsQuery@currentByMahasiswa")
    
    # Get riwayat semua KRS mahasiswa
    krsHistoryByMahasiswa(mahasiswa_id: ID!): [Krs!]!
        @field(resolver: "App\\GraphQL\\Krs\\Queries\\KrsQuery@historyByMahasiswa")
}

extend type Mutation {
    createKrs(input: CreateKrsInput! @spread): Krs
        @create(model: "App\\Models\\Krs")

    updateKrs(
        id: ID! @eq,
        input: UpdateKrsInput! @spread
    ): Krs
        @update(model: "App\\Models\\Krs")

    deleteKrs(id: ID! @eq): Krs
        @delete(model: "App\\Models\\Krs")

    restoreKrs(id: ID!): Krs
        @field(resolver: "App\\GraphQL\\Krs\\Mutations\\KrsMutation@restore")

    forceDeleteKrs(id: ID!): Krs
        @field(resolver: "App\\GraphQL\\Krs\\Mutations\\KrsMutation@forceDelete")
}