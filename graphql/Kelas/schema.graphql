# File: graphql/kelas.graphql (Update/tambahkan query ini)

type Kelas {
    id: ID!
    kode_kelas: String!
    nama_kelas: String!
    mata_kuliah_id: Int!
    dosen_id: Int!
    semester_id: Int!
    kapasitas: Int!
    kuota_terisi: Int!
    status: String!
    created_at: DateTime
    updated_at: DateTime
    deleted_at: DateTime
    
    # Relations
    mataKuliah: MataKuliah! @belongsTo
    dosen: Dosen! @belongsTo
    semester: Semester! @belongsTo
    jadwalKuliah: [JadwalKuliah!]! @hasMany
    krsDetail: [KrsDetail!]! @hasMany
    pertemuan: [Pertemuan!]! @hasMany
}

# Input Types
input CreateKelasInput {
    kode_kelas: String!
    nama_kelas: String!
    mata_kuliah_id: Int!
    dosen_id: Int!
    semester_id: Int!
    kapasitas: Int
    kuota_terisi: Int
    status: String
}

input UpdateKelasInput {
    id: Int
    kode_kelas: String
    nama_kelas: String
    mata_kuliah_id: Int
    dosen_id: Int
    semester_id: Int
    kapasitas: Int
    kuota_terisi: Int
    status: String
}

# Paginator Types
type KelasPaginator {
    data: [Kelas]!
    paginatorInfo: PageInfo!
}

type PageInfo {
    hasMorePages: Boolean!
    currentPage: Int!
    lastPage: Int!
    perPage: Int!
    total: Int!
}

# Queries
extend type Query {
    # Semua kelas
    allKelas: [Kelas!]! @all(model: "Kelas\\Kelas")
    
    # Kelas by ID (untuk detail)
    kelas(id: ID! @eq): Kelas @find(model: "Kelas\\Kelas")
    
    # Kelas dengan pagination
    allKelasPaginate(
        search: String
        first: Int
        page: Int
    ): KelasPaginator @field(resolver: "App\\GraphQL\\Kelas\\Queries\\KelasQuery@all")
    
    # Kelas arsip
    allKelasArsip(
        search: String
        first: Int
        page: Int
    ): KelasPaginator @field(resolver: "App\\GraphQL\\Kelas\\Queries\\KelasQuery@allArsip")
    
    # Kelas by nama
    kelasByNama(
        nama_kelas: String! @where(operator: "like", key: "nama_kelas")
    ): [Kelas]! @all(model: "Kelas\\Kelas")
}

# Mutations
extend type Mutation {
    # Create kelas
    createKelas(input: CreateKelasInput! @spread): Kelas
        @create(model: "Kelas\\Kelas")

    # Update kelas
    updateKelas(
        id: ID! @eq,
        input: UpdateKelasInput! @spread
    ): Kelas
        @update(model: "Kelas\\Kelas")

    # Soft delete kelas
    deleteKelas(id: ID! @eq): Kelas
        @delete(model: "Kelas\\Kelas")

    # Restore kelas
    restoreKelas(id: ID!): Kelas
        @field(resolver: "App\\GraphQL\\Kelas\\Mutations\\KelasMutation@restore")

    # Force delete kelas
    forceDeleteKelas(id: ID!): Kelas
        @field(resolver: "App\\GraphQL\\Kelas\\Mutations\\KelasMutation@forceDelete")
}